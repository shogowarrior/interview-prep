
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../">
      
      
        <link rel="next" href="../postgresql-interview-examples/">
      
      
      <link rel="icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.18">
    
    
      
        <title>PostgreSQL Advanced Window Functions - Complete Guide - Interview Concepts</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#postgresql-advanced-window-functions-complete-guide" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="Interview Concepts" class="md-header__button md-logo" aria-label="Interview Concepts" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Interview Concepts
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              PostgreSQL Advanced Window Functions - Complete Guide
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-hidden="true"  type="radio" name="__palette" id="__palette_0">
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-hidden="true"  type="radio" name="__palette" id="__palette_1">
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-hidden="true"  type="radio" name="__palette" id="__palette_2">
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../.." class="md-tabs__link">
        
  
  
    
  
  Interview Concepts

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../../" class="md-tabs__link">
          
  
  
  Concepts

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../interviews/" class="md-tabs__link">
          
  
  
  Interviews

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="Interview Concepts" class="md-nav__button md-logo" aria-label="Interview Concepts" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Interview Concepts
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Interview Concepts
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Concepts
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Concepts
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Concepts Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Data Modeling
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Data Modeling
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Data-Modeling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Data Modeling Concepts
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2_2" id="__nav_2_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    01 core entities
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_2">
            <span class="md-nav__icon md-icon"></span>
            01 core entities
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Data-Modeling/01-core-entities/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Core Entities
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Data-Modeling/01-core-entities/accounts-profiles/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Accounts &amp; Profiles Modeling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Data-Modeling/01-core-entities/content-catalog-modeling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Content Catalog Modeling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Data-Modeling/01-core-entities/subscriptions-billing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Subscriptions &amp; Billing Modeling
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_2_3" id="__nav_2_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    02 relationships patterns
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_3">
            <span class="md-nav__icon md-icon"></span>
            02 relationships patterns
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Data-Modeling/02-relationships-patterns/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Relationships &amp; Patterns
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Data-Modeling/02-relationships-patterns/many-to-many-relationships/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Many-to-Many Relationships
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Data-Modeling/02-relationships-patterns/recommendations-storage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Recommendations Storage Modeling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Data-Modeling/02-relationships-patterns/user-viewing-history/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    User Viewing History Modeling
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_2_4" id="__nav_2_2_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    03 event streaming
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_4">
            <span class="md-nav__icon md-icon"></span>
            03 event streaming
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Data-Modeling/03-event-streaming/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Event Streaming
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Data-Modeling/03-event-streaming/ab-testing-data-models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    A/B Testing Data Models
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Data-Modeling/03-event-streaming/engagement-metrics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Engagement Metrics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Data-Modeling/03-event-streaming/streaming-quality-metrics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Streaming Quality Metrics
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_5" >
        
          
          <label class="md-nav__link" for="__nav_2_2_5" id="__nav_2_2_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    04 scalability patterns
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_5">
            <span class="md-nav__icon md-icon"></span>
            04 scalability patterns
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Data-Modeling/04-scalability-patterns/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Scalability Patterns
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Data-Modeling/04-scalability-patterns/event-streaming-at-scale/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Event Streaming at Scale
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Data-Modeling/04-scalability-patterns/partitioning-sharding/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Partitioning &amp; Sharding
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_6" >
        
          
          <label class="md-nav__link" for="__nav_2_2_6" id="__nav_2_2_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Streaming Services
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_6">
            <span class="md-nav__icon md-icon"></span>
            Streaming Services
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Data-Modeling/Streaming-Services/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Data Modeling Concepts for Streaming Services
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Data-Modeling/Streaming-Services/ab-testing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    A/B Testing (experiments, assignments, outcomes)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Data-Modeling/Streaming-Services/accounts-profiles-devices/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Accounts, Profiles, Devices
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Data-Modeling/Streaming-Services/content-catalog/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Content Catalog (titles, seasons, episodes, genres, localization)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Data-Modeling/Streaming-Services/engagement-metrics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Engagement Metrics (DAU by region)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Data-Modeling/Streaming-Services/event-streaming-at-scale/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Event Streaming @ scale (schema, processing, queryability)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Data-Modeling/Streaming-Services/partitioning-sharding/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Partitioning &amp; Sharding user watch history
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Data-Modeling/Streaming-Services/recommendations-storage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Recommendations storage (relationships &amp; features)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Data-Modeling/Streaming-Services/streaming-quality/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Streaming Quality (bitrate, buffering, errors)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Data-Modeling/Streaming-Services/subscriptions-billing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Subscriptions, Billing, Promotions, Payments
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Data-Modeling/Streaming-Services/user-viewing-history/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    User Viewing History (partial watch, multiple devices, resume)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" checked>
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    SQL
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            SQL
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SQL Concepts Overview &amp; Learning Hub
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_2" >
        
          
          <label class="md-nav__link" for="__nav_2_3_2" id="__nav_2_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Advanced
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3_2">
            <span class="md-nav__icon md-icon"></span>
            Advanced
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../advanced/advanced-sql-patterns/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Advanced SQL Patterns
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3_3" id="__nav_2_3_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Aggregation
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3_3">
            <span class="md-nav__icon md-icon"></span>
            Aggregation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../aggregation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SQL Aggregation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../aggregation/aggregate-functions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SQL Aggregate Functions: Comprehensive Guide
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../aggregation/monthly-ratings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SQL Question 2: Analyzing Monthly Average Ratings of Airbnb Property Listings
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_4" >
        
          
          <label class="md-nav__link" for="__nav_2_3_4" id="__nav_2_3_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Cte
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3_4">
            <span class="md-nav__icon md-icon"></span>
            Cte
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cte/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Common Table Expressions (CTE)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cte/cte-vs-window-comparison/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CTE vs Window Functions: Performance and Readability Comparison
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cte/customer-sales-analysis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Customer Sales Analysis Using CTE
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cte/vacant-days-detailed/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SQL Question Average Vacant Days for Active Airbnb Listings in 2021
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_5" >
        
          
          <label class="md-nav__link" for="__nav_2_3_5" id="__nav_2_3_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Extras
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3_5">
            <span class="md-nav__icon md-icon"></span>
            Extras
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../extras/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SQL Extras - External Content Repository
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../extras/toptal/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SQL Interview Questions Streaming &amp; Media Analytics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../extras/wikibooks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SQL Exercises from Wikibooks
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_6" >
        
          
          <label class="md-nav__link" for="__nav_2_3_6" id="__nav_2_3_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Joins
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_3_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3_6">
            <span class="md-nav__icon md-icon"></span>
            Joins
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../joins/page-impressions-analysis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Page Impressions and User Actions Analysis
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_7" >
        
          
          <label class="md-nav__link" for="__nav_2_3_7" id="__nav_2_3_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Optimization
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_3_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3_7">
            <span class="md-nav__icon md-icon"></span>
            Optimization
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../optimization/sql-optimization-challenges/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SQL Optimization Challenges
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_8" >
        
          
          <label class="md-nav__link" for="__nav_2_3_8" id="__nav_2_3_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Problems
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_3_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3_8">
            <span class="md-nav__icon md-icon"></span>
            Problems
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../problems/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SQL Practice Problems Hub
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../problems/advanced-patterns/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Advanced SQL Patterns
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../problems/optimization-challenges/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SQL Optimization Challenges
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_8_4" >
        
          
          <label class="md-nav__link" for="__nav_2_3_8_4" id="__nav_2_3_8_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    01 basic analytics
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_3_8_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3_8_4">
            <span class="md-nav__icon md-icon"></span>
            01 basic analytics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../problems/01-basic-analytics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Basic Analytics Problems
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../problems/01-basic-analytics/daily-active-users/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Daily Active Users (DAU)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../problems/01-basic-analytics/day-1-retention/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Day-1 Retention
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../problems/01-basic-analytics/most-watched-show-per-day/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Most Watched Show per Day
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_8_5" >
        
          
          <label class="md-nav__link" for="__nav_2_3_8_5" id="__nav_2_3_8_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    02 ranking window functions
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_3_8_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3_8_5">
            <span class="md-nav__icon md-icon"></span>
            02 ranking window functions
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../problems/02-ranking-window-functions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ranking Window Functions Problems
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../problems/02-ranking-window-functions/consecutive-days-watching/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Consecutive Days Watching
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../problems/02-ranking-window-functions/top-3-shows-per-region/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Top 3 Shows per Region
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_9" >
        
          
          <label class="md-nav__link" for="__nav_2_3_9" id="__nav_2_3_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Subqueries
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_3_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3_9">
            <span class="md-nav__icon md-icon"></span>
            Subqueries
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../subqueries/subqueries/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    🔹 Subqueries
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_10" checked>
        
          
          <label class="md-nav__link" for="__nav_2_3_10" id="__nav_2_3_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Window functions
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_3_10_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_3_10">
            <span class="md-nav__icon md-icon"></span>
            Window functions
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PostgreSQL Window Functions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    PostgreSQL Advanced Window Functions - Complete Guide
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    PostgreSQL Advanced Window Functions - Complete Guide
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      🔹 Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#window-frame-specifications" class="md-nav__link">
    <span class="md-ellipsis">
      🖼️ Window Frame Specifications
    </span>
  </a>
  
    <nav class="md-nav" aria-label="🖼️ Window Frame Specifications">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#understanding-window-frames" class="md-nav__link">
    <span class="md-ellipsis">
      Understanding Window Frames
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Understanding Window Frames">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rows-physical-row-based-frames" class="md-nav__link">
    <span class="md-ellipsis">
      ROWS - Physical Row-Based Frames
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#range-logical-value-based-frames" class="md-nav__link">
    <span class="md-ellipsis">
      RANGE - Logical Value-Based Frames
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#groups-group-based-frames" class="md-nav__link">
    <span class="md-ellipsis">
      GROUPS - Group-Based Frames
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#default-frame-behavior" class="md-nav__link">
    <span class="md-ellipsis">
      Default Frame Behavior
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#named-window-specifications" class="md-nav__link">
    <span class="md-ellipsis">
      🏷️ Named Window Specifications
    </span>
  </a>
  
    <nav class="md-nav" aria-label="🏷️ Named Window Specifications">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basic-named-windows" class="md-nav__link">
    <span class="md-ellipsis">
      Basic Named Windows
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#advanced-named-window-techniques" class="md-nav__link">
    <span class="md-ellipsis">
      Advanced Named Window Techniques
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Advanced Named Window Techniques">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#window-inheritance" class="md-nav__link">
    <span class="md-ellipsis">
      Window Inheritance
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#complex-window-combinations" class="md-nav__link">
    <span class="md-ellipsis">
      Complex Window Combinations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-interview-examples" class="md-nav__link">
    <span class="md-ellipsis">
      🎯 Advanced Interview Examples
    </span>
  </a>
  
    <nav class="md-nav" aria-label="🎯 Advanced Interview Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-1-complex-sales-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Example 1 Complex Sales Analysis
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-2-financial-time-series-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Example 2 Financial Time Series Analysis
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-3-customer-behavior-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Example 3 Customer Behavior Analysis
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#performance-optimization" class="md-nav__link">
    <span class="md-ellipsis">
      ⚡ Performance Optimization
    </span>
  </a>
  
    <nav class="md-nav" aria-label="⚡ Performance Optimization">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#index-strategy-for-window-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Index Strategy for Window Functions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Index Strategy for Window Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#optimal-indexing-patterns" class="md-nav__link">
    <span class="md-ellipsis">
      Optimal Indexing Patterns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#performance-best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      Performance Best Practices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#postgresql-specific-optimizations" class="md-nav__link">
    <span class="md-ellipsis">
      PostgreSQL-Specific Optimizations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troubleshooting-common-issues" class="md-nav__link">
    <span class="md-ellipsis">
      🔍 Troubleshooting Common Issues
    </span>
  </a>
  
    <nav class="md-nav" aria-label="🔍 Troubleshooting Common Issues">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#issue-1-unexpected-results-with-default-frames" class="md-nav__link">
    <span class="md-ellipsis">
      Issue 1 Unexpected Results with Default Frames
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#issue-2-performance-degradation" class="md-nav__link">
    <span class="md-ellipsis">
      Issue 2 Performance Degradation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#issue-3-memory-issues" class="md-nav__link">
    <span class="md-ellipsis">
      Issue 3 Memory Issues
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-patterns" class="md-nav__link">
    <span class="md-ellipsis">
      🎯 Advanced Patterns
    </span>
  </a>
  
    <nav class="md-nav" aria-label="🎯 Advanced Patterns">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pattern-1-complex-aggregations" class="md-nav__link">
    <span class="md-ellipsis">
      Pattern 1 Complex Aggregations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pattern-2-time-series-with-gaps" class="md-nav__link">
    <span class="md-ellipsis">
      Pattern 2 Time Series with Gaps
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pattern-3-sessionization" class="md-nav__link">
    <span class="md-ellipsis">
      Pattern 3 Sessionization
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#related-topics" class="md-nav__link">
    <span class="md-ellipsis">
      📚 Related Topics
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../postgresql-interview-examples/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PostgreSQL Window Functions - Interview Examples
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../postgresql-navigation-functions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PostgreSQL Navigation Functions - Complete Guide
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../postgresql-ranking-functions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PostgreSQL Ranking Functions - Complete Guide
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../window-avg-comparison/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PostgreSQL Window Functions AVG with OVER() Clause
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../window-avg-simplified/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PostgreSQL Window Functions Advanced AVG with OVER()
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../window-functions-overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    🔹 PostgreSQL Window Functions - Complete Guide
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    System Design
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            System Design
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../System-Design/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    System Design &amp; Advanced Concepts
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../System-Design/case-studies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Case Studies
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../System-Design/experimentation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Experimentation and A/B Testing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../System-Design/performance-optimization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Performance Optimization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../System-Design/system-architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    System Architecture
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Interviews
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Interviews
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../interviews/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Interview Problems Collection
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Anthropic
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Anthropic
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../interviews/Anthropic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Anthropic Interview Questions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../interviews/Anthropic/anthropic-chatgpt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    🧠 Anthropic Interview Prep Sheet
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../interviews/Anthropic/anthropic-claude/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Consolidated Anthropic Interview Questions
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Netflix
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            Netflix
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../interviews/netflix/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Netflix Interview Preparation
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Okareo
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            Okareo
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../interviews/okareo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Okareo Interview - Dice Consistency Check
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      🔹 Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#window-frame-specifications" class="md-nav__link">
    <span class="md-ellipsis">
      🖼️ Window Frame Specifications
    </span>
  </a>
  
    <nav class="md-nav" aria-label="🖼️ Window Frame Specifications">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#understanding-window-frames" class="md-nav__link">
    <span class="md-ellipsis">
      Understanding Window Frames
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Understanding Window Frames">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rows-physical-row-based-frames" class="md-nav__link">
    <span class="md-ellipsis">
      ROWS - Physical Row-Based Frames
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#range-logical-value-based-frames" class="md-nav__link">
    <span class="md-ellipsis">
      RANGE - Logical Value-Based Frames
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#groups-group-based-frames" class="md-nav__link">
    <span class="md-ellipsis">
      GROUPS - Group-Based Frames
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#default-frame-behavior" class="md-nav__link">
    <span class="md-ellipsis">
      Default Frame Behavior
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#named-window-specifications" class="md-nav__link">
    <span class="md-ellipsis">
      🏷️ Named Window Specifications
    </span>
  </a>
  
    <nav class="md-nav" aria-label="🏷️ Named Window Specifications">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basic-named-windows" class="md-nav__link">
    <span class="md-ellipsis">
      Basic Named Windows
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#advanced-named-window-techniques" class="md-nav__link">
    <span class="md-ellipsis">
      Advanced Named Window Techniques
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Advanced Named Window Techniques">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#window-inheritance" class="md-nav__link">
    <span class="md-ellipsis">
      Window Inheritance
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#complex-window-combinations" class="md-nav__link">
    <span class="md-ellipsis">
      Complex Window Combinations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-interview-examples" class="md-nav__link">
    <span class="md-ellipsis">
      🎯 Advanced Interview Examples
    </span>
  </a>
  
    <nav class="md-nav" aria-label="🎯 Advanced Interview Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-1-complex-sales-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Example 1 Complex Sales Analysis
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-2-financial-time-series-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Example 2 Financial Time Series Analysis
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-3-customer-behavior-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Example 3 Customer Behavior Analysis
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#performance-optimization" class="md-nav__link">
    <span class="md-ellipsis">
      ⚡ Performance Optimization
    </span>
  </a>
  
    <nav class="md-nav" aria-label="⚡ Performance Optimization">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#index-strategy-for-window-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Index Strategy for Window Functions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Index Strategy for Window Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#optimal-indexing-patterns" class="md-nav__link">
    <span class="md-ellipsis">
      Optimal Indexing Patterns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#performance-best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      Performance Best Practices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#postgresql-specific-optimizations" class="md-nav__link">
    <span class="md-ellipsis">
      PostgreSQL-Specific Optimizations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troubleshooting-common-issues" class="md-nav__link">
    <span class="md-ellipsis">
      🔍 Troubleshooting Common Issues
    </span>
  </a>
  
    <nav class="md-nav" aria-label="🔍 Troubleshooting Common Issues">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#issue-1-unexpected-results-with-default-frames" class="md-nav__link">
    <span class="md-ellipsis">
      Issue 1 Unexpected Results with Default Frames
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#issue-2-performance-degradation" class="md-nav__link">
    <span class="md-ellipsis">
      Issue 2 Performance Degradation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#issue-3-memory-issues" class="md-nav__link">
    <span class="md-ellipsis">
      Issue 3 Memory Issues
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-patterns" class="md-nav__link">
    <span class="md-ellipsis">
      🎯 Advanced Patterns
    </span>
  </a>
  
    <nav class="md-nav" aria-label="🎯 Advanced Patterns">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pattern-1-complex-aggregations" class="md-nav__link">
    <span class="md-ellipsis">
      Pattern 1 Complex Aggregations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pattern-2-time-series-with-gaps" class="md-nav__link">
    <span class="md-ellipsis">
      Pattern 2 Time Series with Gaps
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pattern-3-sessionization" class="md-nav__link">
    <span class="md-ellipsis">
      Pattern 3 Sessionization
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#related-topics" class="md-nav__link">
    <span class="md-ellipsis">
      📚 Related Topics
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="postgresql-advanced-window-functions-complete-guide">PostgreSQL Advanced Window Functions - Complete Guide</h1>
<h2 id="overview">🔹 Overview</h2>
<p>This guide covers advanced PostgreSQL window function concepts including frame specifications, named windows, performance optimization, and complex analytical patterns.</p>
<h2 id="window-frame-specifications">🖼️ Window Frame Specifications</h2>
<h3 id="understanding-window-frames">Understanding Window Frames</h3>
<p>Window frames define which rows are included in the calculation for each row. PostgreSQL supports three frame types:</p>
<h4 id="rows-physical-row-based-frames">ROWS - Physical Row-Based Frames</h4>
<pre><code class="language-sql">ROWS frame_extent
</code></pre>
<p><strong>Frame Extents:</strong></p>
<ul>
<li><code>UNBOUNDED PRECEDING</code> - All rows from partition start to current row</li>
<li><code>n PRECEDING</code> - n rows before current row</li>
<li><code>CURRENT ROW</code> - Current row only</li>
<li><code>n FOLLOWING</code> - n rows after current row</li>
<li><code>UNBOUNDED FOLLOWING</code> - All rows from current row to partition end</li>
</ul>
<p><strong>Examples:</strong></p>
<pre><code class="language-sql">-- Last 3 rows including current
ROWS 2 PRECEDING

-- Current row and next 2
ROWS BETWEEN CURRENT ROW AND 2 FOLLOWING

-- All rows from start to end (complete partition)
ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING
</code></pre>
<h4 id="range-logical-value-based-frames">RANGE - Logical Value-Based Frames</h4>
<pre><code class="language-sql">RANGE frame_extent
</code></pre>
<p><strong>Frame Extents (with ORDER BY required):</strong></p>
<ul>
<li><code>UNBOUNDED PRECEDING</code> - All rows with values &lt;= current row's value</li>
<li><code>n PRECEDING</code> - Rows with values in range [current - n, current]</li>
<li><code>CURRENT ROW</code> - Rows with same value as current row</li>
<li><code>n FOLLOWING</code> - Rows with values in range [current, current + n]</li>
<li><code>UNBOUNDED FOLLOWING</code> - All rows with values &gt;= current row's value</li>
</ul>
<p><strong>Examples:</strong></p>
<pre><code class="language-sql">-- All rows with same or smaller ORDER BY value
RANGE UNBOUNDED PRECEDING

-- Rows within 5 units of current value
RANGE BETWEEN 5 PRECEDING AND 5 FOLLOWING
</code></pre>
<h4 id="groups-group-based-frames">GROUPS - Group-Based Frames</h4>
<pre><code class="language-sql">GROUPS frame_extent
</code></pre>
<p><strong>Frame Extents:</strong></p>
<ul>
<li><code>UNBOUNDED PRECEDING</code> - All peer groups from start to current</li>
<li><code>n PRECEDING</code> - n peer groups before current group</li>
<li><code>CURRENT ROW</code> - Current peer group</li>
<li><code>n FOLLOWING</code> - n peer groups after current group</li>
<li><code>UNBOUNDED FOLLOWING</code> - All peer groups from current to end</li>
</ul>
<h3 id="default-frame-behavior">Default Frame Behavior</h3>
<p>When no frame is specified:</p>
<ul>
<li><strong>With ORDER BY</strong>: <code>RANGE UNBOUNDED PRECEDING</code></li>
<li><strong>Without ORDER BY</strong>: <code>ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING</code></li>
</ul>
<h2 id="named-window-specifications">🏷️ Named Window Specifications</h2>
<h3 id="basic-named-windows">Basic Named Windows</h3>
<p>Use the <code>WINDOW</code> clause to define reusable window specifications:</p>
<pre><code class="language-sql">SELECT
    col1,
    col2,
    function1() OVER my_window,
    function2() OVER my_window
FROM table1
WINDOW my_window AS (PARTITION BY col1 ORDER BY col2);
</code></pre>
<h3 id="advanced-named-window-techniques">Advanced Named Window Techniques</h3>
<h4 id="window-inheritance">Window Inheritance</h4>
<pre><code class="language-sql">SELECT
    col1, col2, col3,
    SUM(col3) OVER base_window,
    AVG(col3) OVER (base_window ROWS 2 PRECEDING),
    MAX(col3) OVER (base_window ORDER BY col1)
FROM table1
WINDOW base_window AS (PARTITION BY col1 ORDER BY col2);
</code></pre>
<h4 id="complex-window-combinations">Complex Window Combinations</h4>
<pre><code class="language-sql">SELECT
    employee_id,
    department,
    salary,
    hire_date,

    -- Department ranking
    ROW_NUMBER() OVER dept_window AS dept_rank,

    -- Department salary percentile
    PERCENT_RANK() OVER dept_window AS dept_percentile,

    -- Company-wide ranking
    ROW_NUMBER() OVER company_window AS company_rank,

    -- Moving average in department
    AVG(salary) OVER (dept_window ROWS 2 PRECEDING) AS dept_moving_avg,

    -- Cumulative salary by hire date
    SUM(salary) OVER (hire_window ROWS UNBOUNDED PRECEDING) AS cumulative_salary

FROM employees
WINDOW
    dept_window AS (PARTITION BY department ORDER BY salary DESC),
    company_window AS (ORDER BY salary DESC),
    hire_window AS (ORDER BY hire_date);
</code></pre>
<h2 id="advanced-interview-examples">🎯 Advanced Interview Examples</h2>
<h3 id="example-1-complex-sales-analysis">Example 1 Complex Sales Analysis</h3>
<pre><code class="language-sql">CREATE TABLE sales_data (
    sale_id INT,
    product_id INT,
    store_id INT,
    sale_date DATE,
    quantity INT,
    price DECIMAL(10,2)
);

INSERT INTO sales_data VALUES
(1, 1, 1, '2024-01-01', 10, 100),
(2, 1, 1, '2024-01-02', 15, 100),
(3, 1, 2, '2024-01-01', 8, 100),
(4, 2, 1, '2024-01-01', 20, 50),
(5, 2, 2, '2024-01-02', 25, 50);

SELECT
    sale_date,
    product_id,
    store_id,
    quantity,
    price,
    quantity * price AS revenue,

    -- Product's daily share within store
    ROUND(
        (quantity * price) /
        SUM(quantity * price) OVER (
            PARTITION BY store_id, sale_date
        ) * 100, 2
    ) AS store_daily_share_pct,

    -- Product's performance vs previous day (same store)
    quantity - LAG(quantity) OVER (
        PARTITION BY product_id, store_id
        ORDER BY sale_date
    ) AS qty_change_from_prev_day,

    -- 7-day moving average (same product, same store)
    ROUND(
        AVG(quantity) OVER (
            PARTITION BY product_id, store_id
            ORDER BY sale_date
            ROWS 6 PRECEDING
        ), 2
    ) AS moving_avg_7d,

    -- Rank within day across all stores
    ROW_NUMBER() OVER (
        PARTITION BY sale_date
        ORDER BY quantity * price DESC
    ) AS daily_rank,

    -- Cumulative revenue by product across all stores
    SUM(quantity * price) OVER (
        PARTITION BY product_id
        ORDER BY sale_date
        ROWS UNBOUNDED PRECEDING
    ) AS cumulative_product_revenue,

    -- Best performing store for this product so far
    FIRST_VALUE(store_id) OVER (
        PARTITION BY product_id
        ORDER BY quantity * price DESC
        ROWS UNBOUNDED PRECEDING
    ) AS best_store_so_far

FROM sales_data
ORDER BY product_id, sale_date, store_id;
</code></pre>
<h3 id="example-2-financial-time-series-analysis">Example 2 Financial Time Series Analysis</h3>
<pre><code class="language-sql">CREATE TABLE stock_prices (
    symbol VARCHAR(10),
    trade_date DATE,
    price DECIMAL(10,2),
    volume INT
);

-- Advanced financial metrics
SELECT
    symbol,
    trade_date,
    price,
    volume,

    -- Price momentum (vs 5 days ago)
    ROUND(
        (price - LAG(price, 5) OVER (
            PARTITION BY symbol
            ORDER BY trade_date
        )) / LAG(price, 5) OVER (
            PARTITION BY symbol
            ORDER BY trade_date
        ) * 100, 2
    ) AS momentum_5d_pct,

    -- 20-day moving average
    ROUND(
        AVG(price) OVER (
            PARTITION BY symbol
            ORDER BY trade_date
            ROWS 19 PRECEDING
        ), 2
    ) AS ma_20d,

    -- Bollinger Band (simplified)
    ROUND(
        AVG(price) OVER (
            PARTITION BY symbol
            ORDER BY trade_date
            ROWS 19 PRECEDING
        ) + 2 * STDDEV(price) OVER (
            PARTITION BY symbol
            ORDER BY trade_date
            ROWS 19 PRECEDING
        ), 2
    ) AS bollinger_upper,

    -- Volume weighted average price (VWAP)
    ROUND(
        SUM(price * volume) OVER (
            PARTITION BY symbol
            ORDER BY trade_date
            ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
        ) / SUM(volume) OVER (
            PARTITION BY symbol
            ORDER BY trade_date
            ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
        ), 2
    ) AS vwap,

    -- Relative Strength Index (simplified)
    CASE
        WHEN ROW_NUMBER() OVER (
            PARTITION BY symbol
            ORDER BY trade_date
        ) &gt;= 14 THEN
            ROUND(
                100 - 100 / (1 + (
                    AVG(CASE WHEN price &gt; LAG(price) OVER (
                        PARTITION BY symbol ORDER BY trade_date
                    ) THEN price - LAG(price) OVER (
                        PARTITION BY symbol ORDER BY trade_date
                    ) END) OVER (
                        PARTITION BY symbol
                        ORDER BY trade_date
                        ROWS 13 PRECEDING
                    ) /
                    AVG(CASE WHEN price &lt; LAG(price) OVER (
                        PARTITION BY symbol ORDER BY trade_date
                    ) THEN LAG(price) OVER (
                        PARTITION BY symbol ORDER BY trade_date
                    ) - price END) OVER (
                        PARTITION BY symbol
                        ORDER BY trade_date
                        ROWS 13 PRECEDING
                    )
                )), 2
            )
    END AS rsi_14

FROM stock_prices
ORDER BY symbol, trade_date;
</code></pre>
<h3 id="example-3-customer-behavior-analysis">Example 3 Customer Behavior Analysis</h3>
<pre><code class="language-sql">CREATE TABLE customer_events (
    customer_id INT,
    event_date DATE,
    event_type VARCHAR(20),
    event_value DECIMAL(10,2)
);

-- Advanced customer analytics
WITH customer_metrics AS (
    SELECT
        customer_id,
        event_date,
        event_type,
        event_value,

        -- Days since first event
        event_date - MIN(event_date) OVER (
            PARTITION BY customer_id
        ) AS days_since_first_event,

        -- Days since previous event
        event_date - LAG(event_date) OVER (
            PARTITION BY customer_id
            ORDER BY event_date
        ) AS days_since_prev_event,

        -- Event sequence number
        ROW_NUMBER() OVER (
            PARTITION BY customer_id
            ORDER BY event_date
        ) AS event_sequence,

        -- Cumulative value by customer
        SUM(event_value) OVER (
            PARTITION BY customer_id
            ORDER BY event_date
            ROWS UNBOUNDED PRECEDING
        ) AS cumulative_value,

        -- Rolling 30-day activity
        COUNT(*) OVER (
            PARTITION BY customer_id
            ORDER BY event_date
            RANGE BETWEEN INTERVAL '30 days' PRECEDING AND CURRENT ROW
        ) AS activity_30d,

        -- Customer lifetime value percentile
        PERCENT_RANK() OVER (
            ORDER BY SUM(event_value) OVER (
                PARTITION BY customer_id
                ORDER BY event_date
                ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING
            )
        ) AS lifetime_value_percentile

    FROM customer_events
)
SELECT
    customer_id,
    event_date,
    event_type,
    event_value,
    days_since_first_event,
    days_since_prev_event,
    event_sequence,
    cumulative_value,
    activity_30d,
    lifetime_value_percentile,

    -- Customer segment based on activity
    CASE
        WHEN activity_30d &gt;= 10 THEN 'High Activity'
        WHEN activity_30d &gt;= 5 THEN 'Medium Activity'
        ELSE 'Low Activity'
    END AS activity_segment,

    -- Value segment based on percentile
    CASE
        WHEN lifetime_value_percentile &gt;= 0.8 THEN 'Top 20%'
        WHEN lifetime_value_percentile &gt;= 0.6 THEN '60-80%'
        ELSE 'Bottom 60%'
    END AS value_segment

FROM customer_metrics
ORDER BY customer_id, event_date;
</code></pre>
<h2 id="performance-optimization">⚡ Performance Optimization</h2>
<h3 id="index-strategy-for-window-functions">Index Strategy for Window Functions</h3>
<h4 id="optimal-indexing-patterns">Optimal Indexing Patterns</h4>
<pre><code class="language-sql">-- For PARTITION BY + ORDER BY
CREATE INDEX idx_table_partition_order ON table_name (partition_col, order_col);

-- For time-based windows
CREATE INDEX idx_table_time ON table_name (partition_col, timestamp_col);

-- For range frames
CREATE INDEX idx_table_range ON table_name (partition_col, numeric_col);
</code></pre>
<h3 id="performance-best-practices">Performance Best Practices</h3>
<ol>
<li><strong>Choose Appropriate Frame Types</strong>:</li>
<li>Use <code>ROWS</code> for physical row navigation</li>
<li>Use <code>RANGE</code> for value-based calculations</li>
<li>
<p>Use <code>GROUPS</code> for peer group analysis</p>
</li>
<li>
<p><strong>Minimize Frame Size</strong>:</p>
</li>
<li>Explicit frames perform better than defaults</li>
<li>
<p>Smaller frames use less memory and CPU</p>
</li>
<li>
<p><strong>Partition Strategy</strong>:</p>
</li>
<li>Smaller partitions = better performance</li>
<li>
<p>Consider partition pruning with proper indexes</p>
</li>
<li>
<p><strong>Memory Management</strong>:</p>
</li>
<li>Monitor work_mem for large result sets</li>
<li>Consider temp_file_limit for disk spilling</li>
</ol>
<h3 id="postgresql-specific-optimizations">PostgreSQL-Specific Optimizations</h3>
<pre><code class="language-sql">-- Enable parallel processing (if beneficial)
SET max_parallel_workers_per_gather = 4;

-- Monitor window function performance
EXPLAIN (ANALYZE, BUFFERS)
SELECT
    id,
    SUM(value) OVER (ORDER BY date ROWS UNBOUNDED PRECEDING)
FROM large_table;

-- Use appropriate work memory
SET work_mem = '256MB';
</code></pre>
<h2 id="troubleshooting-common-issues">🔍 Troubleshooting Common Issues</h2>
<h3 id="issue-1-unexpected-results-with-default-frames">Issue 1 Unexpected Results with Default Frames</h3>
<pre><code class="language-sql">-- Problem: LAST_VALUE returns wrong result
SELECT id, value, LAST_VALUE(value) OVER (ORDER BY id) FROM table1;

-- Solution: Specify explicit frame
SELECT id, value, LAST_VALUE(value) OVER (
    ORDER BY id
    ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING
) FROM table1;
</code></pre>
<h3 id="issue-2-performance-degradation">Issue 2 Performance Degradation</h3>
<pre><code class="language-sql">-- Problem: Slow query with large partitions
SELECT * FROM (
    SELECT *, ROW_NUMBER() OVER (PARTITION BY large_partition ORDER BY col) rn
    FROM huge_table
) t WHERE rn &lt;= 10;

-- Solution: Filter before window function
SELECT * FROM (
    SELECT *, ROW_NUMBER() OVER (ORDER BY col) rn
    FROM (SELECT * FROM huge_table WHERE large_partition = 'target' LIMIT 1000) t
) t WHERE rn &lt;= 10;
</code></pre>
<h3 id="issue-3-memory-issues">Issue 3 Memory Issues</h3>
<pre><code class="language-sql">-- Problem: Out of memory with large frames
SELECT id, SUM(value) OVER (ORDER BY date) FROM large_table;

-- Solution: Use smaller frames or increase work_mem
SET work_mem = '1GB';
SELECT id, SUM(value) OVER (
    ORDER BY date
    ROWS 1000 PRECEDING
) FROM large_table;
</code></pre>
<h2 id="advanced-patterns">🎯 Advanced Patterns</h2>
<h3 id="pattern-1-complex-aggregations">Pattern 1 Complex Aggregations</h3>
<pre><code class="language-sql">SELECT
    category,
    subcategory,
    value,
    -- Category total
    SUM(value) OVER (category_window) AS category_total,
    -- Category average
    AVG(value) OVER (category_window) AS category_avg,
    -- Category rank
    ROW_NUMBER() OVER (category_window) AS category_rank,
    -- Subcategory contribution to category
    ROUND(value / SUM(value) OVER (category_window) * 100, 2) AS category_contribution_pct,
    -- Global rank within category
    ROW_NUMBER() OVER (ORDER BY value DESC) AS global_rank
FROM data_table
WINDOW category_window AS (PARTITION BY category);
</code></pre>
<h3 id="pattern-2-time-series-with-gaps">Pattern 2 Time Series with Gaps</h3>
<pre><code class="language-sql">SELECT
    date,
    value,
    -- Fill gaps using last known value
    COALESCE(
        value,
        LAST_VALUE(value) IGNORE NULLS OVER (
            ORDER BY date
            ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING
        )
    ) AS filled_value,
    -- Moving average excluding NULLs
    AVG(value) IGNORE NULLS OVER (
        ORDER BY date
        ROWS 6 PRECEDING
    ) AS moving_avg_ignore_nulls
FROM time_series;
</code></pre>
<h3 id="pattern-3-sessionization">Pattern 3 Sessionization</h3>
<pre><code class="language-sql">SELECT
    user_id,
    event_time,
    event_type,
    -- Session ID based on 30-minute gaps
    SUM(
        CASE WHEN EXTRACT(EPOCH FROM (
            event_time - LAG(event_time) OVER (
                PARTITION BY user_id ORDER BY event_time
            )
        )) / 60 &gt; 30 THEN 1 ELSE 0 END
    ) OVER (PARTITION BY user_id ORDER BY event_time) AS session_id,
    -- Events in current session
    COUNT(*) OVER (
        PARTITION BY user_id
        ORDER BY event_time
        ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
    ) - COALESCE(
        SUM(
            CASE WHEN EXTRACT(EPOCH FROM (
                event_time - LAG(event_time) OVER (
                    PARTITION BY user_id ORDER BY event_time
                )
            )) / 60 &gt; 30 THEN COUNT(*) OVER (
                PARTITION BY user_id
                ORDER BY event_time
                ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
            ) END
        ) OVER (PARTITION BY user_id ORDER BY event_time), 0
    ) AS session_event_count
FROM user_events;
</code></pre>
<h2 id="related-topics">📚 Related Topics</h2>
<ul>
<li><a href="../window-functions-overview/"><code>concepts/SQL/window-functions/window-functions-overview.md</code></a> - Complete window functions guide</li>
<li><a href="../postgresql-ranking-functions/"><code>concepts/SQL/window-functions/postgresql-ranking-functions.md</code></a> - Ranking functions</li>
<li><a href="../postgresql-navigation-functions/"><code>concepts/SQL/window-functions/postgresql-navigation-functions.md</code></a> - Navigation functions</li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../../..", "features": ["search", "content.code.copy", "navigation.tabs", "navigation.instant", "navigation.tracking", "tabs.sticky", "toc.sticky", "toc.permalink", "toc.follow", "content.tabs", "content.tabs.links", "content.tabs.sticky", "content.tabs.indicator"], "search": "../../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.92b07e13.min.js"></script>
      
    
  </body>
</html>